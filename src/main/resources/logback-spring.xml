<?xml version="1.0" encoding="UTF-8"?>
<configuration>

	<property name="app_home" value="." />
	<!-- Pattern should be shorter since we don't need full year, timezone, 
		complete Request IDs, service/host name, etc. -->
	<property name="PATTERN"
			  value="%magenta(%date{yy-MM-dd'T'HH:mm:ss.SSS}) %highlight(%-5level) %green(%10.10thread) %yellow([%-0.-8mdc{X-Request-Id:--}, %X{traceId:-}, %X{spanId:-}]) %cyan(%logger{5}) - %msg%n" />
	<!-- no /data directory there! -->
	<property name="FILE_PATH" value="${app_home}/logs/app.log" />
	<property name="ROLLING_FILENAME_PATTERN"
		value="${app_home}/logs/app.%d{yyyy-MM-dd}.log" />

	<appender name="STDOUT"
		class="ch.qos.logback.core.ConsoleAppender">
		<withJansi>true</withJansi>
		<encoder
			class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<charset>UTF-8</charset>
			<Pattern>
				${PATTERN}
			</Pattern>
		</encoder>
	</appender>

	<appender name="FILE"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${FILE_PATH}</file>
		<encoder
			class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<charset>UTF-8</charset>
			<Pattern>
				${PATTERN}
			</Pattern>
		</encoder>

		<rollingPolicy
			class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<fileNamePattern>${ROLLING_FILENAME_PATTERN}</fileNamePattern>
			<maxHistory>10</maxHistory>
		</rollingPolicy>
	</appender>

	<root level="WARN">
		<!-- TODO: Look into Async appenders for efficiency. -->
		<appender-ref ref="FILE" />
		<appender-ref ref="STDOUT" />
	</root>

	<springProfile name="dev,alpha">
		<logger
			name="sg.ntuchealth.yoda.edge" level="DEBUG"/>
	</springProfile>

	<springProfile name="uat">	
		<logger
			name="sg.ntuchealth.yoda.edge" level="DEBUG"/>
	</springProfile>

	<springProfile name="prod">
		<logger
			name="sg.ntuchealth.yoda.edge" level="DEBUG"/>
	</springProfile>

	<logger
		name="org.springframework.*" level="DEBUG"/>
		
	<logger
		name="org.hibernate.engine.internal.StatisticalLoggingSessionEventListener"
		level="WARN" />
</configuration>